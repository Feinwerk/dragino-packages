
START=55
USE_PROCD=1

init_board() {

    board=`cat /var/iot/board`
    mode=`uci get gateway.general.server_type`
    process="lora_pkt_fwd"

}

start_service() {
    init_board
    procd_open_instance
    procd_set_param command /usr/bin/"$process"
    procd_set_param file  /etc/config/gateway
    procd_set_param stdout "$DEB"
    procd_set_param respawn 360 5 5
    procd_set_param pidfile /var/run/"$process".pid
    procd_close_instance
}

reload_service() {
    stop
    start
}

service_triggers()
{
    procd_add_reload_trigger "network" "wireless" "gateway" "mqtt" "tcp_client"
    for iface in `cat /etc/config/network | grep interface | awk -F "\'"  '{print $2}'`; do
        procd_add_interface_trigger "interface.*.up" "$iface" /etc/init.d/lora_gw reload
    done
}
